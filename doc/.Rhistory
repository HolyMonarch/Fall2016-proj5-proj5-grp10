add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a,
autosize=False,
width=500,
height=500,
margin=go.Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
),
paper_bgcolor='#7f7f7f',
plot_bgcolor='#c7c7c7')
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a,
autosize=False,
width=500,
height=500,
margin=go.Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
),
paper_bgcolor='#7f7f7f',
plot_bgcolor='#c7c7c7')
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a,
autosize=False,
width=500,
height=500,
margin=go.Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
))
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(autosize=False,
width=500,
height=500,
margin=go.Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
))
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(autosize=False,
width=500,
height=500)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(
width=500,
height=500)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(width=500,
height=300)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(
width=500,
height=400,
margin=go.Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
))
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(
width=500,
height=400,
margin=Margin(
l=50,
r=50,
b=100,
t=100,
pad=4
))
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>%
layout(
width=500,
height=400,
margin=(
l=50,
r=50,
b=100,
t=100,
pad=4
))
?layout
m <- list(
l = 50,
r = 50,
b = 100,
t = 100,
pad = 4
)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F, width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout( width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F,  margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F, width = 500, height = 300, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F, width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F, margin = m)
f2 <- list(
family = "Old Standard TT, serif",
size = 10,
color = "black"
)
a <- list(
title = "AXIS TITLE",
titlefont = f1,
showticklabels = TRUE,
tickangle = 45,
tickfont = f2,
exponentformat = "E"
)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''),
xaxis = a) %>% layout(autosize = F, margin = m)
library(ggplot2)
library(plotly)
library(dplyr)
source('../lib/simplify_breeds.R')
# get shelter data and keep dogs only
load("../data/shelter_data_new.RData")
D = shelter_data_new
D = D[D$`Animal Type`=='Dog',]
D$Breed = tolower(D$Breed)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''), xaxis = a) %>%
layout(autosize = F, width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''), xaxis = a) %>%
layout(autosize = F, width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''), xaxis = a) %>%
layout(autosize = F, width = 500, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''), xaxis = a) %>%
layout(autosize = F, width = 1000, height = 500, margin = m)
plot_ly(adoption_rate, x = ~Breed, y = ~Adoption, name = 'Adoption rate', type = 'scatter', mode = 'lines') %>%
add_trace(y = ~Euthanasia, name = 'Euthanasia rate', mode = 'lines') %>%
add_trace(y = ~Return.to.Owner, name = 'Return to Owner rate', mode = 'lines') %>%
add_trace(y = ~Transfer, name = 'Transfer rate', mode = 'lines') %>%
layout(title = 'Dog Breeds versus Outcome Type',
yaxis = list(title = ''), xaxis = a) %>%
layout(autosize = F, width = 1000, height = 500, margin = m)
library(ggplot2)
library(plotly)
library(dplyr)
library(networkD3)
library("colorspace")
source('../lib/simplify_breeds.R')
# get shelter data
load("../data/shelter_data_new.RData")
data <- shelter_data_new
Outcome <- data.frame(Type = shelter_data_new$'Outcome Type')
unique(shelter_data_new$`Outcome Type`)
o_piechart <- plot_ly(Outcome, labels = ~Type, values = ~freq, type = 'pie',marker = list(colors = terrain_hcl(9))) %>%
layout(title = 'Percentage of Outcome',
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE)) %>%
layout(autosize = F, width = 500, height = 500)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
unique(Outcome$Type)
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
Outcome
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
which(is.na(Outcome$Type))
Outcome$Type <- factor(Outcome$Type, levels = Outcome$Type)
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
o_piechart <- plot_ly(Outcome, labels = ~Type, values = ~freq, type = 'pie',marker = list(colors = terrain_hcl(9))) %>%
layout(title = 'Percentage of Outcome',
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
o_piechart
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
Outcome$Type <- factor(Outcome$Type, levels = Outcome$Type)
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
Outcome
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
Outcome$Type <- factor(Outcome$Type, levels = unique(Outcome$Type))
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
Outcome
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
unique(Outcome$Type)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
Outcome$Type <- factor(Outcome$Type, levels = c("Return to Owner", "Transfer", "Adoption", "Euthanasia", "Died", "Missing", "Disposal", "Relocate"))
unique(Outcome$Type)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != NA)
Outcome$Type <- factor(Outcome$Type, levels = c("Return to Owner", "Transfer", "Adoption", "Euthanasia", "Died", "Missing", "Disposal", "Relocate"))
unique(Outcome$Type)
data<-shelter_data_new
unique(Outcome$Type)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != NA)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
unique(Outcome$Type)
View(Outcome)
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
View(Outcome)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
View(Outcome)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter('Outcome Type' != "")
unique(data$'Outcome Type')
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome$Type <- filter(Outcome, 'Outcome Type' != "")
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome <- filter(Outcome, 'Outcome Type' != "")
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
View(Outcome)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome <- filter(Outcome, 'Outcome Type' != NA)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome <- filter(Outcome, 'Outcome Type' != NA)
Outcome <- Outcome[which(is.na(Outcome$Type)), ]
data<-shelter_data_new
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome <- Outcome[which(is.na(Outcome$Type)), ]
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome$Type[which(is.na(Outcome$Type))] = "Unknown"
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
View(Outcome)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome$Type[which(is.na(Outcome$Type))] = "Unknown"
unique(Outcome$Type)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome$Type[which(is.na(Outcome$Type))] = "Unknown"
sum(Outcome$Type == "")
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome$Type[which(Outcome$Type == "")] = "Unknown"
unique(Outcome$Type)
Outcome <- data.frame(Type = data$'Outcome Type')
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter(Type != "")
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter(Type != "")
Outcome$Type <- factor(Outcome$Type, levels = c("Return to Owner", "Transfer", "Adoption", "Euthanasia", "Died", "Missing", "Disposal", "Relocate"))
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
o_piechart <- plot_ly(Outcome, labels = ~Type, values = ~freq, type = 'pie',marker = list(colors = terrain_hcl(9))) %>%
layout(title = 'Percentage of Outcome',
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
View(Outcome)
library(ggplot2)
library(plotly)
library(dplyr)
library(networkD3)
library("colorspace")
source('../lib/simplify_breeds.R')
# get shelter data
load("../data/shelter_data_new.RData")
colnames(shelter_data_new)[1:20]
colnames(shelter_data_new)
data<-shelter_data_new
Outcome <- data.frame(Type = data$'Outcome Type') %>% filter(Type != "")
Outcome <-Outcome %>%
group_by(Type) %>%
summarise(freq = length(Type))
o_piechart <- plot_ly(Outcome, labels = ~Type, values = ~freq, type = 'pie',marker = list(colors = terrain_hcl(9))) %>%
layout(title = 'Percentage of Outcome',
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
o_piechart
animal.num<-function(dataset){
record_time<-seq(as.Date("2013-10-01"),as.Date("2015-09-30"),by="day")
n<-length(record_time)
take_in_num<-vector()
for (i in 1:n){
take_in_num[i]<-length(which(dataset$`Intake Date`<= record_time[i]))
}
take_out_num<-vector()
for (i in 1:n){
take_out_num[i]<-length(which(dataset$`Outcome Date`<= record_time[i]))
}
animal_in_shelter<-take_in_num-take_out_num
return(data.frame(record_time,animal_in_shelter))
}
all_type_animal_num<-animal.num(data)
animal.type.num<-function(dataset){
dog_data<-dataset[which(dataset$`Animal Type`=="Dog"),]
cat_data<-dataset[which(dataset$`Animal Type`=="Cat"),]
livestock_data<-dataset[which(dataset$`Animal Type`=="Livestock"),]
other_data<-dataset[which(dataset$`Animal Type`=="Other"),]
bird_data<-dataset[which(dataset$`Animal Type`=="Bird"),]
dog_num<-animal.num(dog_data)
cat_num<-animal.num(cat_data)
livestock_num<-animal.num(livestock_data)
other_num<-animal.num(other_data)
bird_num<-animal.num(bird_data)
hehe<-data.frame(dog_num,cat_num[,2],livestock_num[,2],other_num[,2],bird_num[,2])
colnames(hehe)<-c("Record Time",unique(data$`Animal Type`))
return(hehe)
}
group_animal_num<-animal.type.num(data)
group_animal_num$All <- all_type_animal_num$animal_in_shelter
Seasonality<-plot_ly(group_animal_num, x=~`Record Time`, y=~Dog,
type = 'scatter', mode = 'lines',name='Dogs',
line = list(color = 'rgb(126, 172, 247)', width = 2),visible = "legendonly")%>%
add_trace(y=~Cat,type = 'scatter', mode = 'lines',name='Cats',
line =  list(color = 'rgb(110, 209, 146)', width = 2),visible = "legendonly")%>%
add_trace(y=~Livestock,type='scatter', mode = 'lines',name='Livestock',
line =  list(color = 'rgb(216, 137, 110)', width = 2),visible = "legendonly")%>%
add_trace(y=~Other,type='scatter', mode = 'lines',name='Other',
line =  list(color = 'rgb(149, 153, 193)', width = 2),visible = "legendonly")%>%
add_trace(y=~Bird,type='scatter', mode = 'lines',name='Birds',
line =  list(color = 'rrgb(244, 220, 66)', width = 2),visible = "legendonly")%>%
add_trace(y=~All,type='scatter', mode = 'lines',name='All',
line =  list(color = "red", width = 3),visible = TRUE)%>%
layout(title = "Numbers of group in shelter over time",
xaxis = list(
rangeselector = list(
buttons = list(
list(count = 3,label = "3 mo",step = "month",stepmode = "backward"),
list(count = 6,label = "6 mo",step = "month",stepmode = "backward"),
list(count = 1,label = "1 yr",step = "year",stepmode = "backward"),
list(step = "all"))),
rangeslider = list(type = "date")),
yaxis = list(title = "",showgrid = FALSE,zeroline = FALSE,showline = FALSE))
Seasonality
animal.num<-function(dataset){
record_time<-seq(as.Date("2013-10-01"),as.Date("2015-09-30"),by="day")
n<-length(record_time)
take_in_num<-vector()
for (i in 1:n){
take_in_num[i]<-length(which(dataset$`Intake Date`<= record_time[i]))
}
take_out_num<-vector()
for (i in 1:n){
take_out_num[i]<-length(which(dataset$`Outcome Date`<= record_time[i]))
}
animal_in_shelter<-take_in_num-take_out_num
return(data.frame(record_time,animal_in_shelter))
}
all_type_animal_num<-animal.num(data)
animal.type.num<-function(dataset){
dog_data<-dataset[which(dataset$`Animal Type`=="Dog"),]
cat_data<-dataset[which(dataset$`Animal Type`=="Cat"),]
livestock_data<-dataset[which(dataset$`Animal Type`=="Livestock"),]
other_data<-dataset[which(dataset$`Animal Type`=="Other"),]
bird_data<-dataset[which(dataset$`Animal Type`=="Bird"),]
dog_num<-animal.num(dog_data)
cat_num<-animal.num(cat_data)
livestock_num<-animal.num(livestock_data)
other_num<-animal.num(other_data)
bird_num<-animal.num(bird_data)
hehe<-data.frame(dog_num,cat_num[,2],livestock_num[,2],other_num[,2],bird_num[,2])
colnames(hehe)<-c("Record Time",unique(data$`Animal Type`))
return(hehe)
}
group_animal_num<-animal.type.num(data)
